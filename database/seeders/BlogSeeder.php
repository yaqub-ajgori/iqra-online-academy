<?php

namespace Database\Seeders;

use App\Models\BlogCategory;
use App\Models\BlogPost;
use App\Models\BlogTag;
use App\Models\User;
use Illuminate\Database\Seeder;
use Illuminate\Support\Str;

class BlogSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        // Create real blog categories
        $categories = [
            [
                'name' => 'কুরআন ও তাফসীর',
                'slug' => 'quran-tafsir',
                'description' => 'পবিত্র কুরআনের আয়াত ও তাফসীর সংক্রান্ত আলোচনা',
                'color' => '#16a085',
                'icon' => 'book-open',
                'sort_order' => 1,
            ],
            [
                'name' => 'হাদিস ও সুন্নাহ',
                'slug' => 'hadith-sunnah',
                'description' => 'রাসূলুল্লাহ (সা.) এর হাদিস ও সুন্নাহর আলোকে জীবন পরিচালনা',
                'color' => '#27ae60',
                'icon' => 'scroll',
                'sort_order' => 2,
            ],
            [
                'name' => 'ইবাদত ও আমল',
                'slug' => 'worship-deeds',
                'description' => 'নামাজ, রোজা, হজ্জ, যাকাত ও অন্যান্য ইবাদত',
                'color' => '#8e44ad',
                'icon' => 'hands-praying',
                'sort_order' => 3,
            ],
            [
                'name' => 'ইসলামিক জীবনযাত্রা',
                'slug' => 'islamic-lifestyle',
                'description' => 'দৈনন্দিন জীবনে ইসলামিক নির্দেশনা ও আদব-আখলাক',
                'color' => '#e67e22',
                'icon' => 'heart',
                'sort_order' => 4,
            ],
        ];

        foreach ($categories as $categoryData) {
            BlogCategory::firstOrCreate(['slug' => $categoryData['slug']], $categoryData);
        }

        // Create comprehensive blog tags
        $tags = [
            'কুরআন', 'তাফসীর', 'হাদিস', 'সুন্নাহ', 'নামাজ', 'রোজা', 
            'হজ্জ', 'যাকাত', 'দুআ', 'তাজউইদ', 'তিলাওয়াত', 'আখলাক',
            'সীরাত', 'ইসলামের ইতিহাস', 'ফিকহ', 'আকীদা', 'তাওহীদ',
            'পবিত্রতা', 'উযু', 'গোসল', 'তাহাজ্জুদ', 'ইস্তিগফার',
            'রমজান', 'ঈদ', 'পারিবারিক জীবন', 'সন্তান লালন-পালন'
        ];

        foreach ($tags as $tagName) {
            BlogTag::firstOrCreate(
                ['slug' => Str::slug($tagName)],
                [
                    'name' => $tagName,
                    'slug' => Str::slug($tagName)
                ]
            );
        }

        // Get the first admin user as author
        $author = User::first();

        // Create real, detailed Islamic blog posts
        $posts = [
            [
                'title' => 'পবিত্র কুরআনের নূরে জীবন গড়ি: তিলাওয়াতের আদব ও ফজিলত',
                'excerpt' => 'কুরআন তিলাওয়াতের সঠিক আদব, শিষ্টাচার এবং এর অসীম ফজিলত সম্পর্কে বিস্তারিত জানুন। প্রতিটি হরফে রয়েছে দশ নেকী।',
                'content' => '<p>আল্লাহ তাআলা বলেন, "আমি এ কুরআন নাজিল করেছি যাতে তোমরা এর আয়াতসমূহ নিয়ে গভীরভাবে চিন্তা করো।" (সূরা সাদ: ২৯)</p>

<h2>কুরআন তিলাওয়াতের আদব</h2>
<h3>১. পবিত্রতা অর্জন</h3>
<p>কুরআন তিলাওয়াতের আগে অজু করা উত্তম। হাদিস শরীফে এসেছে, "অজু ছাড়া কুরআন স্পর্শ করো না।"</p>

<h3>২. ক্বিবলামুখী হওয়া</h3>
<p>সম্ভব হলে ক্বিবলামুখী হয়ে বসে তিলাওয়াত করা সুন্নাত। এটি মনে একাগ্রতা আনে।</p>

<h3>৩. আউযুবিল্লাহ ও বিসমিল্লাহ পড়া</h3>
<p>তিলাওয়াতের শুরুতে "আউযুবিল্লাহি মিনাশ শাইতানির রাজীম" এবং "বিসমিল্লাহির রহমানির রহীম" পড়া।</p>

<h2>তিলাওয়াতের ফজিলত</h2>
<ul>
<li><strong>প্রতি হরফে দশ নেকী:</strong> রাসূলুল্লাহ (সা.) বলেছেন, "যে ব্যক্তি কুরআনের একটি হরফ পড়বে, সে একটি নেকী পাবে এবং প্রতিটি নেকী দশগুণ বৃদ্ধি পাবে।"</li>
<li><strong>শাফাআত:</strong> কুরআন কিয়ামতের দিন পাঠকারীর জন্য শাফাআত করবে।</li>
<li><strong>মর্যাদা বৃদ্ধি:</strong> "কুরআানের ধারককে বলা হবে: পড়ো, উঠো এবং ধীরে ধীরে পড়ো যেমন দুনিয়ায় পড়তে। তোমার স্থান সেখানে যেখানে তোমার শেষ আয়াত শেষ হবে।"</li>
</ul>

<h2>তাজওয়ীদের গুরুত্ব</h2>
<p>কুরআন সুন্দর ও সঠিক উচ্চারণে পড়া ফরজ। আল্লাহ তাআলা বলেন, "কুরআনকে ধীরে ধীরে স্পষ্টভাবে পড়ো।" (সূরা মুযযাম্মিল: ৪)</p>

<h3>মাখরাজের গুরুত্ব</h3>
<p>প্রতিটি হরফের সঠিক উচ্চারণস্থল (মাখরাজ) জানা জরুরি। ভুল উচ্চারণে অর্থ পরিবর্তন হয়ে যেতে পারে।</p>

<h2>দৈনন্দিন তিলাওয়াতের আমল</h2>
<ul>
<li>ফজরের পর ১৫-২০ মিনিট কুরআন তিলাওয়াত</li>
<li>মাগরিবের পর পারিবারিকভাবে কুরআন পড়া</li>
<li>শুক্রবার সূরা কাহফ পড়া</li>
<li>প্রতিদিন কমপক্ষে এক পৃষ্ঠা কুরআন পড়া</li>
</ul>

<p>আল্লাহ আমাদের সবাইকে কুরআনের সাথে গভীর সম্পর্ক স্থাপন করার তাওফিক দান করুন। আমীন।</p>',
                'category_id' => 1,
                'featured_image' => 'https://images.unsplash.com/photo-1609599006353-e629aaabfeae?w=1200&h=600&fit=crop',
                'status' => 'published',
                'is_featured' => true,
                'is_sticky' => true,
                'published_at' => now()->subDays(2),
                'tags' => ['কুরআন', 'তিলাওয়াত', 'তাজউইদ', 'আদব'],
            ],
            [
                'title' => 'রাসূলুল্লাহ (সা.) এর সুন্নাহ: দৈনন্দিন জীবনের পথপ্রদর্শক',
                'excerpt' => 'নবী করীম (সা.) এর পবিত্র সুন্নাহ আমাদের জীবনের প্রতিটি ক্ষেত্রে পথপ্রদর্শক। জানুন দৈনন্দিন জীবনে সুন্নাহ পালনের উপায়।',
                'content' => '<p>আল্লাহ তাআলা বলেন, "রাসূল তোমাদের যা দেন তা গ্রহণ করো এবং যা থেকে নিষেধ করেন তা থেকে বিরত থাকো।" (সূরা হাশর: ৭)</p>

<h2>সুন্নাহর মর্যাদা</h2>
<p>সুন্নাহ হলো রাসূলুল্লাহ (সা.) এর কথা, কাজ ও সমর্থন। এটি কুরআনের পর দ্বিতীয় প্রধান ইসলামী উৎস।</p>

<h2>দৈনন্দিন জীবনে সুন্নাহ</h2>

<h3>সকালে ঘুম থেকে ওঠার সুন্নাহ</h3>
<ul>
<li>ঘুম থেকে উঠে "আলহামদুলিল্লাহিল্লাজী আহইয়ানা" পড়া</li>
<li>ফজরের আগে তাহাজ্জুদ নামাজ পড়া</li>
<li>মিসওয়াক ব্যবহার করা</li>
</ul>

<h3>খাওয়ার সুন্নাহ</h3>
<ul>
<li>বিসমিল্লাহ বলে খাওয়া শুরু করা</li>
<li>ডান হাত দিয়ে খাওয়া</li>
<li>তিনবারে পানি পান করা</li>
<li>আলহামদুলিল্লাহ বলে খাওয়া শেষ করা</li>
</ul>

<h3>পোশাক পরিধানের সুন্নাহ</h3>
<ul>
<li>ডান দিক থেকে পোশাক পরা</li>
<li>সাদা রঙের পোশাক পছন্দ করা</li>
<li>পোশাক পরার সময় দুআ পড়া</li>
</ul>

<h2>আচার-আচরণের সুন্নাহ</h2>

<h3>সালাম ও মুসাফাহা</h3>
<p>রাসূলুল্লাহ (সা.) বলেছেন, "তোমরা সালামের প্রসার ঘটাও।" সাক্ষাতে সালাম দেওয়া এবং মুসাফাহা করা সুন্নাহ।</p>

<h3>হাসিমুখে কথা বলা</h3>
<p>"তোমার ভাইর মুখে হাসি ফোটানোও সদকা।" - হাদিস শরীফ</p>

<h3>অতিথি সেবা</h3>
<p>রাসূলুল্লাহ (সা.) অতিথিদের অত্যন্ত সম্মান করতেন এবং সেবা করতেন।</p>

<h2>রাতের সুন্নাহ আমল</h2>
<ul>
<li>ইশার পর অযথা দেরি না করে ঘুমানো</li>
<li>ঘুমানোর আগে আয়াতুল কুরসী পড়া</li>
<li>সূরা মুলক পড়া</li>
<li>তিনবার সূরা ইখলাস, ফালাক ও নাস পড়া</li>
<li>ডান কাতে শুয়ে ঘুমানো</li>
</ul>

<h2>সুন্নাহ পালনের ফজিলত</h2>
<p>রাসূলুল্লাহ (সা.) বলেছেন, "যে আমার সুন্নাহকে জীবিত রাখল, সে আমাকে ভালোবাসল। আর যে আমাকে ভালোবাসল, সে জান্নাতে আমার সাথে থাকবে।"</p>

<p>আল্লাহ আমাদের সবাইকে রাসূলুল্লাহ (সা.) এর সুন্নাহ অনুসরণ করার তাওফিক দান করুন। আমীন।</p>',
                'category_id' => 2,
                'featured_image' => 'https://images.unsplash.com/photo-1609599006353-e629aaabfeae?w=1200&h=600&fit=crop',
                'status' => 'published',
                'is_featured' => true,
                'published_at' => now()->subDays(5),
                'tags' => ['হাদিস', 'সুন্নাহ', 'দৈনন্দিন জীবন', 'আদব'],
            ],
            [
                'title' => 'নামাজের গুরুত্ব ও ফজিলত: মুমিনের মেরাজ',
                'excerpt' => 'নামাজ ইসলামের দ্বিতীয় স্তম্ভ এবং মুমিনের মেরাজ। জানুন নামাজের অসীম গুরুত্ব, ফজিলত এবং সঠিক পদ্ধতি।',
                'content' => '<p>আল্লাহ তাআলা বলেন, "নামাজ কায়েম করো, যাকাত প্রদান করো এবং রুকুকারীদের সাথে রুকু করো।" (সূরা বাকারা: ৪৩)</p>

<h2>নামাজের গুরুত্ব</h2>
<p>নামাজ ইসলামের পাঁচটি স্তম্ভের মধ্যে দ্বিতীয় এবং সবচেয়ে গুরুত্বপূর্ণ। রাসূলুল্লাহ (সা.) বলেছেন, "নামাজ দ্বীনের স্তম্ভ।"</p>

<h2>পাঁচ ওয়াক্ত নামাজ</h2>

<h3>১. ফজর নামাজ</h3>
<ul>
<li><strong>সময়:</strong> সুবহে সাদিক থেকে সূর্যোদয় পূর্ব পর্যন্ত</li>
<li><strong>রাকাত:</strong> ২ রাকাত সুন্নাত + ২ রাকাত ফরজ</li>
<li><strong>ফজিলত:</strong> ফজরের নামাজ সারারাত দাঁড়িয়ে থাকার সমান</li>
</ul>

<h3>২. যোহর নামাজ</h3>
<ul>
<li><strong>সময়:</strong> সূর্য পশ্চিমে ঢলে পড়ার পর থেকে আসর পর্যন্ত</li>
<li><strong>রাকাত:</strong> ৪ সুন্নাত + ৪ ফরজ + ২ সুন্নাত</li>
<li><strong>ফজিলত:</strong> জুমআর দিন যোহরের পূর্বে ৪ রাকাত পড়লে জাহান্নামের আগুন হারাম</li>
</ul>

<h3>৩. আসর নামাজ</h3>
<ul>
<li><strong>সময়:</strong> যোহরের শেষ থেকে সূর্যাস্ত পর্যন্ত</li>
<li><strong>রাকাত:</strong> ৪ রাকাত ফরজ</li>
<li><strong>ফজিলত:</strong> যে আসর নামাজ ছেড়ে দেয়, তার আমল নষ্ট হয়ে যায়</li>
</ul>

<h3>৪. মাগরিব নামাজ</h3>
<ul>
<li><strong>সময়:</strong> সূর্যাস্ত থেকে পশ্চিম আকাশের লালিমা অদৃশ্য হওয়া পর্যন্ত</li>
<li><strong>রাকাত:</strong> ৩ রাকাত ফরজ + ২ রাকাত সুন্নাত</li>
<li><strong>ফজিলত:</strong> মাগরিবের পর সূরা ফাতিহা ৭ বার পড়লে সব গুনাহ মাফ</li>
</ul>

<h3>৫. ইশা নামাজ</h3>
<ul>
<li><strong>সময়:</strong> পশ্চিম আকাশের লালিমা অদৃশ্য হওয়ার পর থেকে মধ্যরাত পর্যন্ত</li>
<li><strong>রাকাত:</strong> ৪ রাকাত ফরজ + ২ রাকাত সুন্নাত + ৩ রাকাত বিতর</li>
<li><strong>ফজিলত:</strong> ইশা ও ফজর জামাতে পড়লে সারারাত নামাজে দাঁড়ানোর সওয়াব</li>
</ul>

<h2>নামাজের ফজিলত</h2>

<h3>আধ্যাত্মিক ফজিলত</h3>
<ul>
<li>আল্লাহর সাথে সরাসরি সম্পর্ক স্থাপন</li>
<li>গুনাহ মাফের উসিলা</li>
<li>মনের প্রশান্তি ও আত্মিক পবিত্রতা</li>
<li>জান্নাতের নিশ্চয়তা</li>
</ul>

<h3>শারীরিক ও মানসিক উপকার</h3>
<ul>
<li>নিয়মিত ব্যায়ামের মতো উপকার</li>
<li>মানসিক চাপ কমায়</li>
<li>ধৈর্য ও অধ্যবসায় বৃদ্ধি</li>
<li>সামাজিক বন্ধন মজবুত</li>
</ul>

<h2>নামাজে খুশু-খুজুর গুরুত্ব</h2>
<p>আল্লাহ তাআলা বলেন, "মুমিনরা সফল হয়েছে, যারা তাদের নামাজে বিনয়ী।" (সূরা মুমিনুন: ১-২)</p>

<h3>খুশু-খুজু অর্জনের উপায়</h3>
<ul>
<li>নামাজের অর্থ বুঝে পড়া</li>
<li>দুনিয়ার চিন্তা থেকে মুক্ত থাকা</li>
<li>ধীরস্থিরভাবে নামাজ পড়া</li>
<li>আল্লাহর সামনে দাঁড়ানোর অনুভূতি</li>
</ul>

<h2>জামাতে নামাজের ফজিলত</h2>
<p>রাসূলুল্লাহ (সা.) বলেছেন, "জামাতে নামাজ পড়া একাকী নামাজ পড়ার চেয়ে ২৭ গুণ উত্তম।"</p>

<p>আল্লাহ আমাদের সবাইকে নিয়মিত নামাজ আদায় করার তাওফিক দান করুন। আমীন।</p>',
                'category_id' => 3,
                'featured_image' => 'https://images.unsplash.com/photo-1609599006353-e629aaabfeae?w=1200&h=600&fit=crop',
                'status' => 'published',
                'is_featured' => true,
                'published_at' => now()->subDays(8),
                'tags' => ['নামাজ', 'ইবাদত', 'ফিকহ', 'ফজিলত'],
            ],
        ];

        $allTags = BlogTag::all();

        foreach ($posts as $postData) {
            $tagNames = $postData['tags'];
            unset($postData['tags']);
            
            $postData['author_id'] = $author->id;
            $postData['slug'] = Str::slug($postData['title']);
            $postData['reading_time'] = $this->calculateReadingTime($postData['content']);
            
            $post = BlogPost::firstOrCreate(['slug' => $postData['slug']], $postData);
            
            // Attach tags
            $tagIds = $allTags->whereIn('name', $tagNames)->pluck('id');
            $post->tags()->sync($tagIds);
        }

        $this->command->info('Real Islamic blog content seeded successfully!');
    }

    /**
     * Calculate reading time based on content.
     */
    private function calculateReadingTime(string $content): int
    {
        $wordCount = str_word_count(strip_tags($content));
        return max(1, ceil($wordCount / 200)); // Assuming 200 words per minute
    }
}